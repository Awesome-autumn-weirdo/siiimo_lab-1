# Лабораторная работа №1  
## Построение и оценка регрессионных моделей

---

## Введение
Цель работы — исследовать набор данных о прокате велосипедов, построить регрессионные модели (линейную и гребневую), оценить их качество с помощью метрик RMSE, R^2 и MAPE, а также устранить мультиколлинеарность и снизить размерность признаков с помощью метода главных компонент (PCA).  

Задачи:
1. Провести анализ данных и выявить признаки с высокой корреляцией.  
2. Построить модели линейной и гребневой регрессии.  
3. Оценить качество моделей до и после устранения мультиколлинеарности.  
4. Использовать PCA для снижения размерности и сравнить результаты.  

---

## Анализ данных
Для исследования использовался датасет day.csv (Bike Sharing Dataset), содержащий 731 запись и 16 признаков.  

Основные признаки:
- `season`, `yr`, `mnth`, `weekday`, `holiday`, `workingday`, `weathersit` — категориальные и булевые характеристики.  
- `temp`, `atemp`, `hum`, `windspeed` — числовые признаки.  
- `cnt` — целевая переменная (общее количество арендованных велосипедов за день).  

### Распределение целевой переменной
Гистограмма показала, что данные распределены асимметрично, с выраженным пиком в диапазоне 1000–5000 аренд.

### Корреляции
Корреляционная матрица выявила сильную линейную зависимость между признаками `temp` и `atemp`.  
Для формальной проверки был рассчитан VIF (Variance Inflation Factor):  
- `temp` — 63.32  
- `atemp` — 64.34  
Остальные признаки имеют VIF < 5, то есть мультиколлинеарность отсутствует.  

---

## Подготовка данных
1. Исключены признаки `instant`, `dteday`, `casual`, `registered`.  
2. Данные разделены на признаки `X` и целевую переменную `y`.  
3. Выполнена стандартизация признаков с помощью `StandardScaler`.  
4. Разделение на выборки: train/test = 80/20.  
5. Кросс-валидация: KFold (5 фолдов, shuffle=True, random_state=42).  

---

## Ход работы

### 1. Модели до устранения мультиколлинеарности
Были построены:
- Линейная регрессия 
- Гребневая регрессия с подбором гиперпараметра `alpha`  

#### Метрики:
| Модель                          | RMSE    | R²     | MAPE    |
|--------------------------------|---------|--------|---------|
| Линейная (с atemp)             | 831.29  | 0.828  | 149.38% |
| Гребневая (с atemp, α=10)      | 832.36  | 0.827  | 148.81% |
| Линейная (без atemp)           | 832.78  | 0.827  | 147.25% |
| Гребневая (без atemp, α=10)    | 834.08  | 0.827  | 147.01% |

Вывод: исключение признака `atemp` практически не ухудшило качество моделей.  

---

### 2. PCA (устранение мультиколлинеарности)
Для устранения корреляции между `temp` и `atemp` применён метод главных компонент (PCA).  

#### Метод локтя  
По кумулятивной доле объяснённой дисперсии выбрано 8 главных компонент, объясняющих 95% общей дисперсии.  

#### Метрики на PCA-признаках:
| Модель                  | RMSE    | R²     | MAPE    |
|--------------------------|---------|--------|---------|
| Линейная PCA             | 852.42  | 0.819  | 146.24% |
| Гребневая PCA (α=10)     | 854.40  | 0.818  | 146.29% |

---

## Заключение
1. Датасет демонстрирует выраженную мультиколлинеарность между признаками `temp` и `atemp` (VIF > 60).  
2. Исключение признака `atemp` позволило устранить проблему без существенной потери качества модели.  
3. Метод PCA снизил размерность до 8 компонент, однако качество моделей немного ухудшилось (RMSE вырос, R^2 снизился).  
4. Наиболее интерпретируемыми и стабильными оказались модели без PCA, но с исключением мультиколлинеарного признака.  

---

## Список источников
1. Bike Sharing Dataset: [UCI Machine Learning Repository](https://archive.ics.uci.edu/dataset/275/bike+sharing+dataset)  
2. Айвазян С.А. Методы эконометрики. – М.: Магистр: - ИНФРА-М, 2010. – 512 с. 
3. [Документация Scikit-learn](https://scikit-learn.ru/stable/user_guide.html)
4. [Документация Pandas](https://pandas.pydata.org/docs/)

---

## Приложение
Полный листинг кода приведён в файле [`lab-1.ipynb`](./lab-1.ipynb).

